# 元素

> 本文中出现的 “元素”，若非特殊声明，一律指代 “React 元素”。

什么是元素？按照[官网的描述](https://reactjs.org/docs/rendering-elements.html)，元素是组成 React 应用的最小单元。具体一点，元素就是 JavaScript 对象。

## 1. JSX

在开发 React 应用时，通常会使用 JSX 语法代替 `React.createElment()` 来创建元素。JSX 通过 Babel 转译后同样是使用 `React.createElment()` 来创建元素。例如：

```jsx
<h1>Hello, world!</h1>
```

通过 Babel 转译后生成：

```js
React.createElement('h1', null, 'Hello, world!');
```

注意，转译后的代码使用了 `React` 命名空间，所以在使用 JSX 时会要求导入 React。

## 2. 元素对象

元素通过 `React.createElment()` 方法创建：

```js
React.createElement(type, [props], [...children]);
```

它返回的结构如下（省略开发环境使用的字段）：

```ts
interface ReactElement {
  // 标识符，标记一个对象是 React 元素，值为 `Symbol.for('react.element')`
  $$typeof: symbol;
  // 元素类型，包括用户组件、DOM 元素、React 元素类型
  type: any;
  // 从属性对象 props 中获取的 key
  key: any;
  // 从属性对象 props 中获取的 ref
  ref: any;
  // 属性对象，移除了 key 和 ref 属性，并将 chilren 合并
  props: any;
  // 创建此元素的 Fiber 节点
  _owner: Fiber;
}
```

根据上面的结构，在判断一个对象是否是 React 元素时便非常容易，只需要判断对象中是否有 React 元素标识符即可：

```js
function isValidElement(object) {
  return (
    typeof object === 'object' &&
    object !== null &&
    object.$$typeof === Symbol.for('react.element')
  );
}
```

React 也提供 `React.isValidElement()` 方法来判断一个对象是否是一个 React 元素，其内部实现与上面的判断方式一模一样。

## 3. 创建过程

## 4. 结构分析

下面以一个示例来窥探元素在应用中是如何被创建的。

```jsx
import React, { Component } from 'react';
import ReactDOM from 'react-dom';

class App extends Component {
  render() {
    return <h1>Hello, world!</h1>;
  }
}

ReactDOM.render(<App />, document.getElementById('root'));
```

通过 Babel 转译后的代码：

```js
import React, { Component } from 'react';
import ReactDOM from 'react-dom';

class App extends Component {
  render() {
    return React.createElement('h1', null, 'Hello, world!');
  }
}

ReactDOM.render(
  React.createElement(App, null),
  document.getElementById('root')
);
```
